{% extends 'Base.html' %}
{% load static humanize FindSubUser %}
{{ form.media }}
{% block title %} Accounts {% endblock %}
{% load findNextMonth %}

{% load findNextYear %}



{% block content %}
<style>
  @import compass;

  .product {
    position: relative;
    text-align: center
  }

  .br-0 {
    border-radius: 0px !important;
  }

  .promotion {
    top: 5px;
    display: block;
    padding: 1.5% 1.8%;
    padding-top: 10px;
    margin-top: 10px;
    -moz-border-radius: 50%;
    -webkit-border-radius: 50%;
    border-radius: 60%;
    width: 270px;
    height: 270px;
    background: rgb(129, 105, 105)
  }

  em,
  strong {
    font-size: 1.3em;
  }
</style>




<style>
  body {
    margin: 0;
    padding: 0;
  }

  .flip-card {
    background-color: transparent;
    width: 300px;
    height: 300px;
    perspective: 1000px;
    border-radius: 50% !important;
  }

  .flip-card-inner {

    width: 100%;
    height: 100%;
    position: relative;
    text-align: center;
    transition: transform 0.6s;
    transform-style: preserve-3d;
    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
    background-color: transparent;
    border-radius: 50% !important;
  }

  .flip-card:hover .flip-card-inner {
    transform: rotateY(180deg);
  }

  .flip-card-front,
  .flip-card-back {
    position: absolute;
    width: 100%;
    height: 100%;
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
  }

  .flip-card-front {
    background-color: transparent;
    color: black;
  }

  .flip-card-back {
    background-color: #2980b9;
    color: white;
    transform: rotateY(180deg);
  }

  .modal-dialog {
    max-width: 800px !important;
  }
</style>

<script src="{% static 'music/js/jquery-2.2.4.min.js' %}"></script>
<script>

  function updateSlider() {

    var x = $('[name="options"]');
    var y = $('[name="accounts"]');
    var z = $('[name="totalcostAmount"]');
    var w = $('#savings_amount');
    var results = 0;
    if ($("#options1").is(':checked')) {

      results = parseFloat(parseFloat(z.val()) - (parseInt(y.val()) * 30)) * 12;
    }

    if ($("#options2").is(':checked')) {

      results = parseFloat(parseFloat(z.val()) - (parseInt(y.val()) * 30)) * 12;
    }

    if ($("#options3").is(':checked')) {

      results = parseFloat(parseFloat(z.val()) - (parseInt(y.val()) * 35)) * 12;
    }



    if (results < 0) {
      results = "Looks like you already have a great deal! You might want to compare what youâ€™re getting on your plan compared to one of ours";
      w.css("font-size", "14px");

      w.html(results);
    }
    else {

      if (isNaN(results)) {
        results = 0;
      }
      var R = "$" + results + "/year";
      w.html(R);
    }



  }



</script>

<script>
  
    function PlanCreationFunction(x, y){
      
      
      // console.log(j);
      // console.log($("#id_category option:contains(j)"));
      // $("#id_category option:contains(j)");
      $('#id_category').val(y).trigger('change');
      for(var i = 0; i < $("#selectContains").find("select").length; i++)
      {
        
           
          
          
        
        if ($($("#selectContains").find("select")[i]).attr("id") == ("id_plan_name_" +  x + ""))
        {
          
          
          $($("#selectContains").find("select")[i]).show();
        }
        else{
          $($("#selectContains").find("select")[i]).hide();
        }
      }
      
      
    }
  
</script>



<script>
  function updateLine(){
    var v = $("#id_currently_monthly_payment_per_line").val().trim();
    if (v.length == 0)
    {
      $("#currentLinePayment").hide();
    }
    else{
      $("#currentLinePayment").show();
    }
    var c =  $("#id_category :selected").text();
    var j  = 0
    if (c == "VERIZON")
    {
      j = ( v-30 )*12;
    }
    else if(c == "T-MOBILES")
    {
      j = ( v-28 )*12;
    }
    else if(c == "AT-T")
    {
      j = ( v-35 )*12;
    }
    
    var r  ="Great! We can save you about $" +  j + " per line a year."
    $("#currentLinePayment").html(r);
  }
</script>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add plan</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form method="POST" action="{% url 'home' %}">
          {% csrf_token %}
          {{ form.media }}
          <div class="card-body">

            {% if form.errors %}
            {% for field in form %}
            {% for error in field.errors %}
            <div class="alert alert-warning alert-dismissible fade show" role="alert">
              <h5 class="alert-heading">{{ field.label }}</h5>
              <hr>
              <p class="mb-0">{{ error|escape }}</p>
              <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            {% endfor %}
            {% endfor %}
            {% endif %}
            {% csrf_token %}
            <div class="row">
              <div class="col-md-5">
                <div class="form-group">
                  <label>Category</label>
                  
                  <select name="category" required="" id="id_category" class="form-control" 
                  onchange="updateLine();">
                    {% if categories %}
                      {% for category in categories %}
                        <option value="{{ category.id}}">{{ category.slug|upper   }}</option>
                      {% endfor %}
                    {% endif %}
                  </select>

                </div>
                <div class="form-group" id="selectContains">
                  <label>Plan Name</label>
                    
                    <select class="form-control"  name="plan_name" id="id_plan_name_default" >

                    </select>

                    <select class="form-control"  name="plan_name" id="id_plan_name_verizon" data-target="Verizon" style="display: none;">
                      <option value="Start Unlimited">Start Unlimited</option>
                      <option value="Play More Unlimited">Play More Unlimited</option>
                      <option value="Do More Unlimited">Do More Unlimited</option>
                      <option value="Get More Unlimited">Get More Unlimited</option>
                      
                    </select>
                   

                    <select class="form-control" name="plan_name" id="id_plan_name_t-mobiles"
                    data-target="T-Mobiles" style="display: none;">
                    <option value="Essentials">Essentials</option>
                      <option value="Magenta">Magenta</option>
                      <option value="Magenta Plus">Magenta Plus</option>

                    </select>
                    <select class="form-control" name="plan_name" id="id_plan_name_AT-T"
                    data-target="AT&T" style="display: none;">
                    <option value="Unlimited Elite">Unlimited Elite</option>
                      <option value="Unlimited Extra">Unlimited Extra</option>
                      <option value="Unlimited Starter">Unlimited Starter</option>

                    </select>


                </div>
                <div class="form-group">
                  <label>Family Name</label>
                  <input type="text" name="family_name" maxlength="150" class="form-control" required=""
                    {% if form.family_name.value %} value="{{ form.family_name.value}}" {% endif %}>
                </div>
              </div>
              <div class="col-md-2"></div>
              <div class="col-md-5">

                <div class="form-group">
                  <label>Total Available Slots</label>
                    {{ form.total_slots }}
                </div>
                <div class="form-group">

                  <label>Next Recurring Bill Date</label>
                  <div class="input-group date" data-provide="datepicker" data-date-format="dd">
                    <input type="text" class="form-control" name="monthly_payment_date">
                    <div class="input-group-addon">
                      <span class="glyphicon glyphicon-th"></span>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <label>How much are you currently paying per line?</label>
                  <input type="number" name="currently_monthly_payment_per_line" maxlength="150" id="id_currently_monthly_payment_per_line"
                    {% if form.currently_monthly_payment_per_line.value %}
                    value="{{ form.currently_monthly_payment_per_line.value}}" {% endif %} class="form-control"
                    required="" onkeyup="updateLine()">
                </div>
                <div class="form-group">
                  <label class="text-danger card-text" id="currentLinePayment" style="display: none;"></label>
                </div>
                <div class="form-group">
                  <label>Current Family Size</label>
                  <input type="number" name="currentFamilySize" maxlength="3"
                    {% if form.currentFamilySize.value %}
                    value="{{ form.currentFamilySize.value}}" {% endif %} class="form-control"
                    required="">
                </div>
              </div>
              <div class="col-md-12">
                
                <div class="form-group">
                  <label for="exampleFormControlTextarea1">Additional Notes</label>
                  <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"
                    name="notes">{% if form.notes.value %}{{ form.notes.value}}{% endif %}</textarea>
                </div>
              </div>
            </div>

            <p>
              <br>
              <input type="submit" class="btn btn-primary" value="Save">


              <button type="button" class="btn btn-secondary font-weight-bold" data-dismiss="modal">Cancel</button>



          </div>



        </form>
      </div>
    </div>
  </div>
</div>




<!-- Modal -->
<div class="modal fade" id="exampleModal_1" tabindex="-1" role="dialog" aria-labelledby="exampleModal_1Label"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModal_1Label">Register/Login</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        To add/join a plan, user should have to register/login.
      </div>
      <div class="modal-footer">
        <a type="button" class="btn btn-primary" href="{% url 'register' %}">Register</a>
        <a type="button" class="btn btn-primary" href="{% url 'login' %}">Login</a>
      </div>
    </div>
  </div>
</div>








<!-- ##### Hero Area Start ##### -->
<section class="hero-area bg-img bg-overlay-2by5"
  style="background-image: url( '{% static "music/bg-img/bg1.jpg" %}' );">
  <div class="container h-100">
    <div class="row h-100 align-items-center">
      <div class="col-12">
        <!-- Hero Content -->
        <div class="hero-content text-center">

          {% if request.user.is_authenticated  %}
          <h2>Let's Manage Together</h2>
          {% else %}
          <h2>Let's Manage Together</h2>
          <a href="{% url 'login' %}" class="btn btn-primary .br-0">Get Started</a>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</section>
<!-- ##### Hero Area End ##### -->




<div class="mx-auto" style="width:900px;">
  <div class="card mt-5 border-0" style="width: 60rem; box-shadow: none !important;">
    <div class="card-body">

      <div class="row">
        <div class="col ml-3">
          <div class="row">
            <h5 class="card-title">Current Carrier</h5>
          </div>
          <div class="row">
            <div class="btn-group btn-group-toggle" data-toggle="buttons">
              <label class="btn btn-outline-secondary mr-2">
                <input type="radio" name="options" id="options1" value="1" data-url="3210" onchange="updateSlider();">
                Verizon

              </label>
              <label class="btn btn-outline-secondary mr-2">
                <input type="radio" name="options" id="options2" value="2" data-url="321"
                  onchange="updateSlider();">T-Mobile

              </label>
              <label class="btn btn-outline-secondary">
                <input type="radio" name="options" id="options3" value="3" data-url="231" onchange="updateSlider();">
                AT&T

              </label>
            </div>

          </div>


          <div class="row">
            <div class="col-md-8">
              <label for="customRange1" class="mt-2 pl-0">Number of Users on the Account</label>
              <p for="foo" class="font-weight-bold rounded p-1 pl-0" style="position: relative; border-radius: 50%;">
              </p>
              <input type="range" class="custom-range" name="accounts" id="customRange1" min="1" max="10" value="1"
                onchange="updateSlider();">


            </div>


          </div>
          <div class="row mt-2">
            <h5 class="card-title">Total Plan Cost (US Dollars)</h5>
          </div>
          <div class="row mt-1">
            <div class="col-md-5 pl-5">
              <input type="number" class="form-control" name="totalcostAmount" onkeyup="updateSlider();">
            </div>
          </div>

        </div>
        <div class="col">
          <div class="row pt-0">
            <div class="card bg-success text-white font-weight-bold text-center pt-0 mt-0"
              style="width:300px !important; height: 300px !important; border-radius: 50% !important; margin-top: 0 !important; margin-bottom: 0px !important;">
              <div class="card-body mt-5 text-center">
                <h4 class="card-title text-white mb-5">Savings</h4>
                <h4 class="card-title text-white" id="savings_amount"> $21231321/yr</h4>

              </div>

            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>










<div class="dropdown ml-5 mb-3">
  <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown"
    aria-haspopup="true" aria-expanded="false">
    Filter Results
  </button>
  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton" style="width:200px !important;">
    <form class="px-1 py-1" action="." method="GET">
      <div class="form-group">
        <label for="exampleFormControlSelect1">Based on Category</label>
        <select class="form-control" id="exampleFormControlSelect1" name="category" onchange="this.form.submit();">
          <option vaule="None">None</option>
          <option vaule="All">All</option>
          {% for category in filters %}

          <option vaule="{{ category.Name }}">{{ category.Name }}</option>
          {% endfor %}

        </select>
      </div>

    </form>
  </div>
</div>

{%  if  categories %}

<div class="product">
  <div class="row ml-2 p-5 m-0">

    {% for i in categories  %}

    <p class="list-group-item mb-2 ml-4 font-weight-bold p-2 text-left border-0 pl-5 ml-5 mb-5 mt-5 col-lg-10"
      title="Category : {{ i.Name }}" style="max-width: 80% !important; font-size: 25px;">{{ i.Name }}</p>
    {% if request.user.is_authenticated %}
    <div class="col-md-4">
      <div class="card bg-info text-white font-weight-bold text-center pt-0 mb-2"
        style="width:300px !important; height: 300px !important; border-radius: 50% !important;">
        <div class="card-body mt-5 text-center">
          <h4 class="card-title text-white mb-5"></h4>
          <button href="{% url 'planform' %}" class="btn btn-secondary stretched-link" data-toggle="modal" onclick="PlanCreationFunction('{{ i.slug }}', '{{ i.id }}');"
            data-target="#exampleModal">Add a plan</button>
        </div>
      </div>
    </div>
    {% else %}
    <div class="col-md-4">
      <div class="card bg-transparent text-white font-weight-bold text-center pt-0 mb-2 border-0"
        style="width:300px !important; height: 300px !important; border-radius: 50% !important; box-shadow: none !important;">
        <div class="flip-card bg-transparent">
          <div class="flip-card-inner bg-transparent">
            <div class="flip-card-front bg-success text-white font-weight-bold text-center pt-0"
              style="width:300px !important; height: 300px !important; border-radius: 50% !important;">
              <div class="card-body mt-5 text-center text-secondary">
                <h4 class="card-title text-white mb-5"></h4>
                <button class="btn btn-secondary " data-toggle="modal" data-target="#exampleModal_1">Add a plan</button>
              </div>
            </div>
            <div class="flip-card-back bg-success text-white font-weight-bold text-center pt-0"
              style="width:300px !important; height: 300px !important; border-radius: 50% !important;">
              <div class="card-body mt-5 text-center text-secondary">
                <h4 class="card-title text-white mb-5"></h4>
                <button class="btn btn-secondary" data-toggle="modal" data-target="#exampleModal_1">Login</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endif %}
    {% for j in i.get_plans %}
    <div class="col-md-4 mb-4">
      <div class="flip-card bg-transparent">
        <div class="flip-card-inner bg-transparent">
          <div
            class="flip-card-front {% if request.user.is_authenticated %} {% if request.user|FindSubUser:j.id %} bg-warning {% else %} {% if j.get_available_status %} bg-success {% else %} bg-danger {% endif %}{% endif %} {% else %} {% if j.get_available_status %} bg-success {% else %} bg-danger {% endif %} {% endif %}text-white font-weight-bold text-center pt-0"
            style="width:300px !important; height: 300px !important; border-radius: 50% !important;">
            <h6 class="card-title text-white" style="margin-top: 50%; margin-bottom: 50%;">Plan Name: {{ j.plan_name }}
            </h6>
          </div>
          <div
            class="flip-card-back {% if request.user.is_authenticated %} {% if request.user|FindSubUser:j.id %} bg-warning {% else %} {% if j.get_available_status %} bg-success {% else %} bg-danger {% endif %}{% endif %} {% else %} {% if j.get_available_status %} bg-success {% else %} bg-danger {% endif %} {% endif %} text-white font-weight-bold text-center pt-0"
            style="width:300px !important; height: 300px !important; border-radius: 50% !important;">
            <h6 class="card-title text-white" style="margin-top: 25%;">Plan Name: {{ j.plan_name }}</h6>
            <h6 class="card-title text-white">Family Name: {{ j.family_name }}</h6>
            <h6 class="card-title text-white">Number of Available Slots: {{ j.number_of_open_slots }}</h6>
            <h6 class="card-title text-white">Monthly Payment Date:{{ request.user|findNextMonth }}
              {{ j.monthly_payment_date }}, {{ request.user|findNextYear }}</h6>
            <h6 class="card-title text-white">Monthly Cost: ${{ j.currently_monthly_payment_per_line|intcomma }}</h6>
            {% if request.user.is_authenticated %}
            {% if request.user|FindSubUser:j.id %}
            <a href="{% url 'Join' i.id j.id %}" class="btn btn-secondary alert-link mr-0">Plan Details</a>
            {% else %}
            {% if j.get_available_status %}
            {% if request.user == j.user %}
            <a href="{% url 'Join' i.id j.id %}" class="btn btn-secondary alert-link mr-0">See Details</a>
            {% else %}
            <a href="{% url 'Join' i.id j.id %}" class="btn btn-secondary alert-link mr-0">Join</a>
            {% endif %}

            {% else %}
            <a href="#" class="btn btn-secondary stretched-link mr-0">Full</a>
            {% endif %}
            {% endif %}
            {% else %}
            {% if j.get_available_status %}

            <a href="{% url 'Join' i.id j.id %}" class="btn btn-secondary alert-link mr-0">Join</a>

            {% else %}
            <a href="#" class="btn btn-secondary stretched-link mr-0">Full</a>
            {% endif %}
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    {% endfor %}


    {% endfor %}

  </div>
</div>



{% endif %}




<!-- footer -->
<footer style="background-color: #2c292f">
  <div class="container">
    <div class="row ">
      <div class="col-md-4 text-center text-md-left ">

        <div class="py-0">
          <h3 class="my-4 text-white">About<span class="mx-2 font-italic text-warning ">Circledin</span></h3>

          <p class="footer-links font-weight-bold">
            <a class="text-white" href="#">Home</a>
            |
            <a class="text-white" href="#">Blog</a>
            |
            <a class="text-white" href="#">About</a>
            |
            <a class="text-white" href="#">Contact</a>
          </p>
          <p class="text-light py-4 mb-4">&copy;2020 Circledin Learning Solutions Pvt. Ltd.</p>
        </div>
      </div>

      <div class="col-md-4 text-white text-center text-md-left ">
        <div class="py-2 my-4">
          <div>
            <p class="text-white"> <i class="fa fa-map-marker mx-2 "></i>
              But I must explain to you how all </p>
          </div>

          <div>
            <p><i class="fa fa-phone  mx-2 "></i> +91 22-27782183</p>
          </div>
          <div>
            <p><i class="fa fa-envelope  mx-2"></i><a href="mailto:support@circledin.io">support@circledin.io</a></p>
          </div>
        </div>
      </div>

      <div class="col-md-4 text-white my-4 text-center text-md-left ">
        <span class=" font-weight-bold ">About the Company</span>
        <p class="text-warning my-2">But I must explain to you how all this mistaken idea of denouncing pleasure and
          praising pain was born and I will give you a complete account of the system, and expound the actual teachings
          of the great explorer of the truth, the master-builder of human happiness</p>
        <div class="py-2">
          <a href="#"><i class="fab fa-facebook fa-2x text-primary mx-3"></i></a>
          <a href="#"><i class="fab fa-google-plus fa-2x text-danger mx-3"></i></a>
          <a href="#"><i class="fab fa-twitter fa-2x text-info mx-3"></i></a>
          <a href="#"><i class="fab fa-youtube fa-2x text-danger mx-3"></i></a>
        </div>
      </div>
    </div>
  </div>
</footer>
<!-- end of footer -->


<script>
  $(document).ready(function(){
    $('#id_category').on("change", function()
    {
        if ($("#id_category :selected").text() == "VERIZON"){
              
          $("#id_plan_name_verizon").show();
          $("#id_plan_name_default").hide();
          $("#id_plan_name_t-mobiles").hide();
          $("#id_plan_name_AT-T").hide();

        }
        else if($("#id_category :selected").text() == "T-MOBILES"){
          $("#id_plan_name_verizon").hide();
          $("#id_plan_name_default").hide();
          $("#id_plan_name_t-mobiles").show();
          $("#id_plan_name_AT-T").hide();
        }
        else if($("#id_category :selected").text() == "AT-T"){
          $("#id_plan_name_verizon").hide();
          $("#id_plan_name_default").hide();
          $("#id_plan_name_t-mobiles").hide();
          $("#id_plan_name_AT-T").show();
        }
      
    });
  });
</script>


{% endblock content %}